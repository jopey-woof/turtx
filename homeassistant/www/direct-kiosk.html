<!DOCTYPE html>
<html>
<head>
    <title>Turtle Kiosk - Direct Access</title>
    <style>
        body { 
            background: linear-gradient(135deg, #2D5016, #4A7C59); 
            color: #E8F5E8; 
            font-family: Arial, sans-serif; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0; 
        }
        .container { 
            text-align: center; 
            background: rgba(0,0,0,0.3);
            padding: 40px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .logo { font-size: 3em; margin-bottom: 20px; }
        .status { margin-top: 20px; font-size: 1.2em; }
        .loading { 
            margin-top: 20px; 
            width: 40px; 
            height: 40px; 
            border: 3px solid #E8F5E8; 
            border-top: 3px solid transparent; 
            border-radius: 50%; 
            animation: spin 1s linear infinite; 
            margin-left: auto; 
            margin-right: auto; 
        }
        @keyframes spin { 
            0% { transform: rotate(0deg); } 
            100% { transform: rotate(360deg); } 
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">üê¢</div>
        <div>Turtle Habitat Monitor</div>
        <div class="status" id="status">Loading dashboard...</div>
        <div class="loading" id="loading"></div>
    </div>
    
    <script>
        console.log('Direct kiosk access starting...');
        const statusEl = document.getElementById('status');
        
        function updateStatus(message) { 
            statusEl.textContent = message; 
            console.log('Status:', message); 
        }
        
        // Clear any existing authentication data
        function clearAuth() {
            localStorage.clear();
            sessionStorage.clear();
            console.log('Cleared all auth data');
        }
        
        // Direct access function
        function directAccess() {
            updateStatus('Accessing dashboard directly...');
            
            // Clear any auth data first
            clearAuth();
            
            // Try multiple approaches
            const urls = [
                '/lovelace',
                '/lovelace/default_view',
                '/lovelace/0',
                '/lovelace/dashboard',
                '/lovelace-kiosk',
                '/'
            ];
            
            let currentIndex = 0;
            
            function tryNextUrl() {
                if (currentIndex < urls.length) {
                    const url = urls[currentIndex];
                    updateStatus(`Trying: ${url}`);
                    console.log(`Attempting to access: ${url}`);
                    
                    // Create an iframe to test the URL
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.src = url;
                    
                    iframe.onload = function() {
                        console.log(`Successfully loaded: ${url}`);
                        updateStatus('Dashboard found! Redirecting...');
                        setTimeout(() => {
                            window.location.href = url;
                        }, 1000);
                    };
                    
                    iframe.onerror = function() {
                        console.log(`Failed to load: ${url}`);
                        currentIndex++;
                        setTimeout(tryNextUrl, 500);
                    };
                    
                    // Set a timeout in case iframe doesn't load
                    setTimeout(() => {
                        if (currentIndex < urls.length) {
                            currentIndex++;
                            tryNextUrl();
                        }
                    }, 2000);
                    
                    document.body.appendChild(iframe);
                } else {
                    // All URLs failed, try the most basic approach
                    updateStatus('Using fallback access...');
                    window.location.href = '/lovelace';
                }
            }
            
            // Start trying URLs
            setTimeout(tryNextUrl, 1000);
        }
        
        // Start the direct access process
        setTimeout(directAccess, 2000);
        
        // Ultimate fallback - if nothing works, just go to the main page
        setTimeout(() => {
            updateStatus('Using ultimate fallback...');
            window.location.href = '/';
        }, 15000);
    </script>
</body>
</html> 