<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üê¢ TurtX Monitor</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
        }

        /* Page Management */
        .page {
            height: 100vh;
            width: 100vw;
            display: none;
            flex-direction: column;
            position: absolute;
            top: 0;
            left: 0;
            transition: all 0.3s ease;
        }

        .page.active {
            display: flex;
        }

        /* Animated Header - 15vh */
        .header {
            height: 15vh;
            position: relative;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0c29 100%);
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        /* Twinkling Star Field Background */
        .star-field {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .star {
            position: absolute;
            color: #fff;
            font-size: clamp(0.5rem, 1vw, 1rem);
            animation: twinkle 3s infinite;
            opacity: 0.8;
        }

        .star:nth-child(odd) {
            animation-delay: -1s;
            animation-duration: 2s;
        }

        .star:nth-child(even) {
            animation-delay: -0.5s;
            animation-duration: 4s;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* Moon Phase Display */
        .moon-phase {
            position: absolute;
            top: 1vh;
            right: 2vw;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 10;
            color: #fff;
            text-align: center;
        }

        .moon-icon {
            font-size: clamp(1.5rem, 3vw, 2.5rem);
            margin-bottom: 0.5vh;
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
            animation: moon-glow 4s ease-in-out infinite alternate;
        }

        .moon-info {
            font-size: clamp(0.6rem, 1.2vw, 0.8rem);
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        .moon-phase-name {
            font-size: clamp(0.5rem, 1vw, 0.7rem);
            opacity: 0.9;
            margin-top: 0.2vh;
        }

        @keyframes moon-glow {
            0% { filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5)); }
            100% { filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.8)); }
        }

        /* Nyan Turtle GIF Container */
        .nyan-turtle-container {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            height: 8vh;
            z-index: 5;
            overflow: hidden;
        }

        /* Nyan Turtle Visible */
        .nyan-turtle-visible {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(2.5rem, 5vw, 4rem);
            z-index: 6;
            animation: nyan-turtle-bounce 0.8s ease-in-out infinite;
            filter: drop-shadow(2px 2px 8px rgba(0,0,0,0.4));
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        @keyframes nyan-turtle-bounce {
            0%, 100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
            25% { transform: translate(-48%, -52%) scale(1.05) rotate(-2deg); }
            50% { transform: translate(-50%, -48%) scale(1.1) rotate(0deg); }
            75% { transform: translate(-52%, -52%) scale(1.05) rotate(2deg); }
        }

        /* Nyan Star Overlay Trail */
        .nyan-star-overlay {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            z-index: 7;
            pointer-events: none;
            overflow: hidden;
        }

        .nyan-star {
            position: absolute;
            font-size: clamp(8px, 1.5vw, 16px);
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255,255,255,0.8), 0 0 20px rgba(255,255,255,0.4);
            animation: nyan-star-float 3s linear infinite;
            z-index: 7;
        }

        @keyframes nyan-star-float {
            0% { 
                transform: translateX(10vw) translateY(0px) scale(0.8) rotate(0deg); 
                opacity: 1; 
            }
            100% { 
                transform: translateX(-20vw) translateY(-1vh) scale(0.3) rotate(180deg); 
                opacity: 0; 
            }
        }

        /* Fallback for when no GIF is available - Simple CSS Turtle */
        .nyan-turtle-fallback {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: clamp(2.5rem, 5vw, 4rem);
            z-index: 6;
            animation: simple-bounce 1s ease-in-out infinite;
            filter: drop-shadow(2px 2px 8px rgba(0,0,0,0.4));
        }

        @keyframes simple-bounce {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -55%) scale(1.05); }
        }

        /* Header Title */
        .header-title {
            position: relative;
            z-index: 8;
            color: #fff;
            font-size: clamp(1.8rem, 4.5vw, 3rem);
            font-weight: 700;
            text-shadow: 
                2px 2px 4px rgba(0,0,0,0.8),
                0 0 20px rgba(255,255,255,0.3),
                0 0 40px rgba(255,255,255,0.1);
            letter-spacing: 2px;
            margin-left: 25vw;
        }

        .header-subtitle {
            position: absolute;
            bottom: 1vh;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.8);
            font-size: clamp(0.8rem, 1.8vw, 1.2rem);
            font-weight: 500;
            z-index: 8;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.6);
        }

        /* Main Cards - 45vh */
        .main-cards {
            height: 45vh;
            display: flex;
            gap: 2vw;
            padding: 2vh 2vw;
            overflow: hidden;
        }

        .sensor-card {
            flex: 1;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2vh 1vw;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .sensor-card:hover {
            transform: translateY(-5px);
        }

        .zone-icon {
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 1vh;
        }

        .zone-title {
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            font-weight: 600;
            margin-bottom: 2vh;
        }

        .temp-value {
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: bold;
            margin-bottom: 1vh;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .humidity-value {
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            margin-bottom: 2vh;
            opacity: 0.9;
        }

        .status-bar {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            margin-top: auto;
        }

        .status-excellent { background: #4ade80; }
        .status-warning { background: #facc15; }
        .status-critical { background: #ef4444; }

        /* Weather Card - 10vh */
        .weather-card {
            height: 10vh;
            margin: 0 2vw;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1vh 2vw;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 2vw;
        }

        .weather-icon {
            font-size: clamp(1.5rem, 4vw, 2rem);
        }

        .weather-info {
            flex: 1;
            font-size: clamp(0.8rem, 2vw, 1rem);
        }

        /* System Indicators - 20vh */
        .system-indicators {
            height: 20vh;
            display: flex;
            gap: 1vw;
            padding: 2vh 2vw;
        }

        .indicator {
            flex: 1;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1vh;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .indicator-icon {
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            margin-bottom: 0.5vh;
        }

        .indicator-label {
            font-size: clamp(0.6rem, 1.5vw, 0.8rem);
            margin-bottom: 0.5vh;
            opacity: 0.8;
        }

        .indicator-status {
            font-size: clamp(0.6rem, 1.5vw, 0.8rem);
            font-weight: 600;
            text-transform: uppercase;
            padding: 0.2vh 0.5vw;
            border-radius: 4px;
        }

        /* Navigation - 20vh */
        .navigation {
            height: 20vh;
            display: flex;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-btn {
            flex: 1;
            background: transparent;
            border: none;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1vh;
            font-size: clamp(0.8rem, 2vw, 1rem);
        }

        .nav-btn:hover, .nav-btn.active {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            border-top: 3px solid #4ade80;
        }

        .nav-icon {
            font-size: clamp(1.5rem, 4vw, 2rem);
        }

        /* Camera Page Specific */
        .camera-container {
            height: 55vh;
            padding: 2vh 2vw;
        }

        .camera-feed {
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .camera-stream {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 20px;
            z-index: 1;
        }

        .camera-placeholder {
            position: absolute;
            font-size: clamp(2rem, 5vw, 3rem);
            opacity: 0.5;
            z-index: 2;
            display: none;
        }

        .camera-placeholder.show {
            display: block;
        }

        .camera-error {
            position: absolute;
            color: #ff6b6b;
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            text-align: center;
            z-index: 2;
            display: none;
        }

        .camera-error.show {
            display: block;
        }

        .camera-status {
            position: absolute;
            top: 1vh;
            left: 2vw;
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
            padding: 0.5vh 1vw;
            border-radius: 8px;
            font-size: clamp(0.8rem, 1.5vw, 1rem);
            z-index: 3;
        }

        .camera-status.online {
            border-left: 3px solid #4ade80;
        }

        .camera-status.offline {
            border-left: 3px solid #ef4444;
        }

        .camera-controls {
            height: 10vh;
            display: flex;
            justify-content: center;
            gap: 2vw;
            padding: 1vh 2vw;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 1vh 2vw;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5vh;
            font-size: clamp(0.7rem, 1.8vw, 0.9rem);
        }

        .control-btn:hover {
            transform: scale(1.05);
        }

        /* Data Page Specific */
        .page-header {
            height: 10vh;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2vw;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .data-charts {
            height: 35vh;
            display: flex;
            gap: 2vw;
            padding: 2vh 2vw;
        }

        .chart-card {
            flex: 1;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2vh 1vw;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
        }

        .chart-title {
            font-size: clamp(0.9rem, 2.2vw, 1.2rem);
            font-weight: 600;
            margin-bottom: 1vh;
            text-align: center;
        }

        .chart-values {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2vh;
            font-size: clamp(0.8rem, 2vw, 1rem);
        }

        .chart-placeholder {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.5;
            font-size: clamp(0.7rem, 1.8vw, 0.9rem);
        }

        .activity-log {
            height: 35vh;
            margin: 0 2vw 2vh 2vw;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .log-header {
            padding: 1vh 2vw;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .log-filters {
            display: flex;
            gap: 0.5vw;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 0.5vh 1vw;
            color: #fff;
            cursor: pointer;
            font-size: clamp(0.6rem, 1.5vw, 0.8rem);
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: rgba(74, 222, 128, 0.3);
            border-color: #4ade80;
        }

        .log-entries {
            flex: 1;
            padding: 1vh 2vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 0.5vh;
        }

        .log-entry {
            height: calc((35vh - 8vh) / 6);
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1vh;
            border-left: 3px solid #4ade80;
            display: flex;
            align-items: center;
            gap: 1vw;
            font-size: clamp(0.7rem, 1.8vw, 0.9rem);
            min-height: 3vh;
        }

        .log-time {
            min-width: 15vw;
            opacity: 0.7;
            font-size: clamp(0.6rem, 1.5vw, 0.8rem);
        }

        .log-icon {
            font-size: clamp(0.8rem, 2vw, 1rem);
        }

        .log-message {
            flex: 1;
        }

        /* Status Colors */
        .log-entry.critical { border-left-color: #ef4444; }
        .log-entry.warning { border-left-color: #facc15; }
        .log-entry.info { border-left-color: #4ade80; }

        /* Connection Status */
        .connection-status {
            position: absolute;
            top: 1vh;
            left: 2vw;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 0.5vh 1vw;
            display: flex;
            align-items: center;
            gap: 0.5vw;
            font-size: clamp(0.7rem, 1.8vw, 0.9rem);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .connection-icon {
            font-size: clamp(0.8rem, 2vw, 1rem);
        }

        .connection-text {
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- Page 1: Status Overview -->
    <div class="page active" id="status-page">
        <!-- Connection Status -->
        <div class="connection-status" id="connection-status">
            <span class="connection-icon">üì°</span>
            <span class="connection-text">Connecting...</span>
        </div>

        <!-- Animated Header - 15vh -->
        <div class="header">
            <!-- Twinkling Star Field -->
            <div class="star-field" id="star-field"></div>

            <!-- Moon Phase Display -->
            <div class="moon-phase" id="moon-phase">
                <div class="moon-icon" id="moon-icon">üåô</div>
                <div class="moon-info" id="moon-info">Loading...</div>
                <div class="moon-phase-name" id="moon-phase-name"></div>
            </div>

            <!-- Nyan Turtle GIF Container -->
            <div class="nyan-turtle-container">
                <!-- Nyan Turtle (Using emoji for now, ready for GIF replacement) -->
                <div class="nyan-turtle-visible">üê¢</div>
                
                <!-- Star Overlay Trail -->
                <div class="nyan-star-overlay" id="nyan-star-overlay"></div>
            </div>

            <!-- Header Title -->
            <h1 class="header-title">TurtX Monitor</h1>
            <div class="header-subtitle">Live Habitat Monitoring System</div>
        </div>

        <!-- Main Cards - 45vh -->
        <div class="main-cards">
            <div class="sensor-card">
                <div class="zone-icon">üî•</div>
                <div class="zone-title">Basking Zone</div>
                <div class="temp-value" id="basking-temp">95.2¬∞F</div>
                <div class="humidity-value">Humidity: <span id="basking-humidity">45%</span></div>
                <div class="status-bar status-excellent" id="basking-status"></div>
            </div>
            <div class="sensor-card">
                <div class="zone-icon">‚ùÑÔ∏è</div>
                <div class="zone-title">Cool Zone</div>
                <div class="temp-value" id="cooling-temp">78.5¬∞F</div>
                <div class="humidity-value">Humidity: <span id="cooling-humidity">65%</span></div>
                <div class="status-bar status-excellent" id="cooling-status"></div>
            </div>
        </div>

        <!-- Weather Card - 10vh -->
        <div class="weather-card">
            <div class="weather-icon">üå§Ô∏è</div>
            <div class="weather-info">
                <div>Portland, OR - 72¬∞F - Partly Cloudy</div>
                <div>Wind: 5 mph | Humidity: 68%</div>
            </div>
        </div>

        <!-- System Indicators - 20vh -->
        <div class="system-indicators">
            <div class="indicator">
                <div class="indicator-icon">üå°Ô∏è</div>
                <div class="indicator-label">Heater</div>
                <div class="indicator-status status-excellent">ON</div>
            </div>
            <div class="indicator">
                <div class="indicator-icon">üí°</div>
                <div class="indicator-label">UV Light</div>
                <div class="indicator-status status-excellent">ON</div>
            </div>
            <div class="indicator">
                <div class="indicator-icon">‚ö°</div>
                <div class="indicator-label">Power</div>
                <div class="indicator-status status-excellent">STABLE</div>
            </div>
            <div class="indicator">
                <div class="indicator-icon">üì°</div>
                <div class="indicator-label">Network</div>
                <div class="indicator-status status-excellent">CONNECTED</div>
            </div>
            <div class="indicator">
                <div class="indicator-icon">üö®</div>
                <div class="indicator-label">Alerts</div>
                <div class="indicator-status status-excellent">CLEAR</div>
            </div>
        </div>

        <!-- Navigation - 20vh -->
        <div class="navigation">
            <button class="nav-btn active" onclick="showPage('status')">
                <div class="nav-icon">üìä</div>
                <div>STATUS</div>
            </button>
            <button class="nav-btn" onclick="showPage('camera')">
                <div class="nav-icon">üìπ</div>
                <div>CAMERA</div>
            </button>
            <button class="nav-btn" onclick="showPage('data')">
                <div class="nav-icon">üìà</div>
                <div>DATA</div>
            </button>
        </div>
    </div>

    <!-- Page 2: Camera View -->
    <div class="page" id="camera-page">
        <!-- Header - 15vh -->
        <div class="header">
            <h1>üìπ Live Camera Feed</h1>
        </div>

        <!-- Camera Container - 55vh -->
        <div class="camera-container">
            <div class="camera-feed">
                <!-- Camera Status Indicator -->
                <div class="camera-status offline" id="camera-status">
                    üìπ Camera Offline
                </div>
                
                <!-- Live Camera Stream -->
                <img class="camera-stream" 
                     id="camera-stream" 
                     style="display: none;"
                     alt="Turtle Camera Feed" />
                
                <!-- Camera Placeholder -->
                <div class="camera-placeholder show" id="camera-placeholder">
                    üìπ Connecting to Camera...
                </div>
                
                <!-- Camera Error Message -->
                <div class="camera-error" id="camera-error">
                    ‚ö†Ô∏è Camera Connection Failed<br/>
                    <small>Check camera connection and try refresh</small>
                </div>
            </div>
        </div>

        <!-- Camera Controls - 10vh -->
        <div class="camera-controls">
            <button class="control-btn" onclick="refreshCamera()">
                <div>üîÑ</div>
                <div>Refresh</div>
            </button>
            <button class="control-btn" onclick="switchCamera()">
                <div>üì∑</div>
                <div>Switch Cam</div>
            </button>
            <button class="control-btn" onclick="toggleFullscreen()">
                <div>‚õ∂</div>
                <div>Fullscreen</div>
            </button>
        </div>

        <!-- Navigation - 20vh -->
        <div class="navigation">
            <button class="nav-btn" onclick="showPage('status')">
                <div class="nav-icon">üìä</div>
                <div>STATUS</div>
            </button>
            <button class="nav-btn active" onclick="showPage('camera')">
                <div class="nav-icon">üìπ</div>
                <div>CAMERA</div>
            </button>
            <button class="nav-btn" onclick="showPage('data')">
                <div class="nav-icon">üìà</div>
                <div>DATA</div>
            </button>
        </div>
    </div>

    <!-- Page 3: Data & Logs -->
    <div class="page" id="data-page">
        <!-- Page Header - 10vh -->
        <div class="page-header">
            <h2>üìà Data Analysis & Activity Log</h2>
            <div>Last updated: <span id="last-update">Just now</span></div>
        </div>

        <!-- Data Charts - 35vh -->
        <div class="data-charts">
            <div class="chart-card">
                <div class="chart-title">üå°Ô∏è Temperature Trends</div>
                <div class="chart-values">
                    <div>Basking: <span id="chart-basking-temp">95.2¬∞F</span></div>
                    <div>Cool: <span id="chart-cooling-temp">78.5¬∞F</span></div>
                </div>
                <div class="chart-placeholder">[24H Graph Placeholder]</div>
            </div>
            <div class="chart-card">
                <div class="chart-title">üíß Humidity Trends</div>
                <div class="chart-values">
                    <div>Basking: <span id="chart-basking-humidity">45%</span></div>
                    <div>Cool: <span id="chart-cooling-humidity">65%</span></div>
                </div>
                <div class="chart-placeholder">[24H Graph Placeholder]</div>
            </div>
        </div>

        <!-- Activity Log - 35vh -->
        <div class="activity-log">
            <div class="log-header">
                <h4>üìã Recent Activity</h4>
                <div class="log-filters">
                    <button class="filter-btn active">All</button>
                    <button class="filter-btn">üî¥ Critical</button>
                    <button class="filter-btn">üü° Warning</button>
                    <button class="filter-btn">üîµ Info</button>
                </div>
            </div>
            <div class="log-entries" id="log-entries">
                <div class="log-entry info">
                    <div class="log-time">2 min ago</div>
                    <div class="log-icon">üîµ</div>
                    <div class="log-message">Temperature check completed - all zones optimal</div>
                </div>
                <div class="log-entry info">
                    <div class="log-time">5 min ago</div>
                    <div class="log-icon">üîµ</div>
                    <div class="log-message">UV cycle activated for 30 minutes</div>
                </div>
                <div class="log-entry info">
                    <div class="log-time">8 min ago</div>
                    <div class="log-icon">üîµ</div>
                    <div class="log-message">Motion detected in basking area</div>
                </div>
                <div class="log-entry info">
                    <div class="log-time">12 min ago</div>
                    <div class="log-icon">üîµ</div>
                    <div class="log-message">Humidity levels adjusted automatically</div>
                </div>
                <div class="log-entry info">
                    <div class="log-time">15 min ago</div>
                    <div class="log-icon">üîµ</div>
                    <div class="log-message">System startup completed successfully</div>
                </div>
                <div class="log-entry info">
                    <div class="log-time">18 min ago</div>
                    <div class="log-icon">üîµ</div>
                    <div class="log-message">Daily monitoring session initiated</div>
                </div>
            </div>
        </div>

        <!-- Navigation - 20vh -->
        <div class="navigation">
            <button class="nav-btn" onclick="showPage('status')">
                <div class="nav-icon">üìä</div>
                <div>STATUS</div>
            </button>
            <button class="nav-btn" onclick="showPage('camera')">
                <div class="nav-icon">üìπ</div>
                <div>CAMERA</div>
            </button>
            <button class="nav-btn active" onclick="showPage('data')">
                <div class="nav-icon">üìà</div>
                <div>DATA</div>
            </button>
        </div>
    </div>

    <script>
        let currentPage = 'status';

        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });

            // Show target page
            document.getElementById(pageName + '-page').classList.add('active');

            // Update navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.nav-btn').classList.add('active');

            // Initialize camera when switching to camera page
            if (pageName === 'camera') {
                setTimeout(() => {
                    console.log('üìπ Refreshing camera on page switch...');
                    refreshCamera();
                }, 500);
            }

            currentPage = pageName;
            console.log('Switched to page:', pageName);
        }

        // API Configuration
        const API_BASE_URL = 'http://10.0.20.69/api';
        const API_ENDPOINTS = {
            latest: '/latest',
            health: '/health'
        };

        let isConnected = false;
        let lastDataUpdate = null;

        // Connection status update
        function updateConnectionStatus(connected) {
            isConnected = connected;
            const statusElement = document.querySelector('.connection-status');
            const iconElement = statusElement?.querySelector('.connection-icon');
            const textElement = statusElement?.querySelector('.connection-text');

            if (statusElement && iconElement && textElement) {
                if (connected) {
                    statusElement.style.background = 'rgba(34, 197, 94, 0.2)';
                    statusElement.style.borderColor = '#22c55e';
                    iconElement.textContent = '‚úÖ';
                    textElement.textContent = 'Connected';
                } else {
                    statusElement.style.background = 'rgba(239, 68, 68, 0.2)';
                    statusElement.style.borderColor = '#ef4444';
                    iconElement.textContent = '‚ùå';
                    textElement.textContent = 'Connection Lost';
                }
            }
        }

        // Fetch live sensor data
        async function fetchSensorData() {
            try {
                console.log('üîÑ Fetching sensor data from API...');
                const response = await fetch(`${API_BASE_URL}${API_ENDPOINTS.latest}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    timeout: 5000
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log('‚úÖ API Data received:', data);
                
                updateConnectionStatus(true);
                lastDataUpdate = new Date();
                return data;
            } catch (error) {
                console.error('‚ùå API Error:', error.message);
                updateConnectionStatus(false);
                return null;
            }
        }

        // Data update function with live API integration
        async function updateData() {
            const sensorData = await fetchSensorData();
            
            if (sensorData && sensorData.readings) {
                // Extract sensor values from actual API response structure
                // sensor1 = basking zone (typically warmer), sensor2 = cooling zone
                const sensor1 = sensorData.readings.sensor1 || {};
                const sensor2 = sensorData.readings.sensor2 || {};
                
                const baskingTemp = sensor1.temperature || 0;
                const baskingHumidity = sensor1.humidity || 0;
                const coolingTemp = sensor2.temperature || 0;
                const coolingHumidity = sensor2.humidity || 0;

                // Update all displays with live data
                const elements = {
                    'basking-temp': baskingTemp.toFixed(1) + '¬∞F',
                    'basking-humidity': Math.round(baskingHumidity) + '%',
                    'cooling-temp': coolingTemp.toFixed(1) + '¬∞F',
                    'cooling-humidity': Math.round(coolingHumidity) + '%',
                    'chart-basking-temp': baskingTemp.toFixed(1) + '¬∞F',
                    'chart-basking-humidity': Math.round(baskingHumidity) + '%',
                    'chart-cooling-temp': coolingTemp.toFixed(1) + '¬∞F',
                    'chart-cooling-humidity': Math.round(coolingHumidity) + '%'
                };

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) element.textContent = value;
                });

                // Update status indicators with live data
                const baskingStatus = document.getElementById('basking-status');
                const coolingStatus = document.getElementById('cooling-status');
                
                if (baskingStatus) {
                    baskingStatus.className = 'status-bar ' + getStatusClass(baskingTemp, 90, 100);
                }
                if (coolingStatus) {
                    coolingStatus.className = 'status-bar ' + getStatusClass(coolingTemp, 70, 85);
                }

                console.log(`üê¢ Live Data: Basking ${baskingTemp.toFixed(1)}¬∞F/${baskingHumidity.toFixed(0)}% | Cooling ${coolingTemp.toFixed(1)}¬∞F/${coolingHumidity.toFixed(0)}%`);
                console.log(`üìä Sensor Status: ${sensor1.connection_status} | ${sensor2.connection_status}`);
            } else {
                // Fallback to simulation when API is unavailable
                console.log('‚ö†Ô∏è Using simulated data - API unavailable');
                
                const baskingTemp = 95 + (Math.random() - 0.5) * 4;
                const baskingHumidity = 45 + Math.random() * 10;
                const coolingTemp = 78 + (Math.random() - 0.5) * 4;
                const coolingHumidity = 65 + Math.random() * 15;

                const elements = {
                    'basking-temp': baskingTemp.toFixed(1) + '¬∞F',
                    'basking-humidity': Math.round(baskingHumidity) + '%',
                    'cooling-temp': coolingTemp.toFixed(1) + '¬∞F',
                    'cooling-humidity': Math.round(coolingHumidity) + '%',
                    'chart-basking-temp': baskingTemp.toFixed(1) + '¬∞F',
                    'chart-basking-humidity': Math.round(baskingHumidity) + '%',
                    'chart-cooling-temp': coolingTemp.toFixed(1) + '¬∞F',
                    'chart-cooling-humidity': Math.round(coolingHumidity) + '%'
                };

                Object.entries(elements).forEach(([id, value]) => {
                    const element = document.getElementById(id);
                    if (element) element.textContent = value;
                });

                const baskingStatus = document.getElementById('basking-status');
                const coolingStatus = document.getElementById('cooling-status');
                
                if (baskingStatus) {
                    baskingStatus.className = 'status-bar ' + getStatusClass(baskingTemp, 90, 100);
                }
                if (coolingStatus) {
                    coolingStatus.className = 'status-bar ' + getStatusClass(coolingTemp, 70, 85);
                }
            }

            // Update last update time
            const lastUpdate = document.getElementById('last-update');
            if (lastUpdate) {
                lastUpdate.textContent = new Date().toLocaleTimeString();
            }
        }

        function getStatusClass(temp, min, max) {
            if (temp >= min && temp <= max) return 'status-excellent';
            if (temp > max + 5 || temp < min - 5) return 'status-critical';
            return 'status-warning';
        }

        // Touch navigation support
        let startX = 0;
        document.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
        });

        document.addEventListener('touchend', (e) => {
            const endX = e.changedTouches[0].clientX;
            const deltaX = endX - startX;
            
            if (Math.abs(deltaX) > 50) {
                const pages = ['status', 'camera', 'data'];
                const currentIndex = pages.indexOf(currentPage);
                
                let newIndex;
                if (deltaX > 0 && currentIndex > 0) {
                    newIndex = currentIndex - 1; // Swipe right = previous page
                } else if (deltaX < 0 && currentIndex < pages.length - 1) {
                    newIndex = currentIndex + 1; // Swipe left = next page
                }
                
                if (newIndex !== undefined) {
                    showPage(pages[newIndex]);
                }
            }
        });

        // Moon Phase Calculations
        function getMoonPhase(date = new Date()) {
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();

            // Calculate days since known new moon (Jan 6, 2000)
            const knownNewMoon = new Date(2000, 0, 6);
            const daysSince = (date - knownNewMoon) / (1000 * 60 * 60 * 24);
            
            // Moon cycle is approximately 29.53 days
            const moonCycle = 29.530588853;
            const phase = (daysSince % moonCycle) / moonCycle;
            
            let phaseName, phaseIcon;
            
            if (phase < 0.0625 || phase >= 0.9375) {
                phaseName = "New Moon";
                phaseIcon = "üåë";
            } else if (phase < 0.1875) {
                phaseName = "Waxing Crescent";
                phaseIcon = "üåí";
            } else if (phase < 0.3125) {
                phaseName = "First Quarter";
                phaseIcon = "üåì";
            } else if (phase < 0.4375) {
                phaseName = "Waxing Gibbous";
                phaseIcon = "üåî";
            } else if (phase < 0.5625) {
                phaseName = "Full Moon";
                phaseIcon = "üåï";
            } else if (phase < 0.6875) {
                phaseName = "Waning Gibbous";
                phaseIcon = "üåñ";
            } else if (phase < 0.8125) {
                phaseName = "Last Quarter";
                phaseIcon = "üåó";
            } else {
                phaseName = "Waning Crescent";
                phaseIcon = "üåò";
            }

            const illumination = Math.round(Math.abs(Math.cos(phase * 2 * Math.PI)) * 100);
            
            return { 
                phase: Math.round(phase * 100) / 100, 
                phaseName, 
                phaseIcon, 
                illumination,
                isWaxing: phase < 0.5
            };
        }

        // Create Twinkling Star Field
        function createStarField() {
            const starField = document.getElementById('star-field');
            if (!starField) return;

            const starSymbols = ['‚ú¶', '‚úß', '‚ãÜ', '‚òÖ', '‚òÜ', '‚ú®', '¬∞', '¬∑'];
            const numStars = 25;

            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.textContent = starSymbols[Math.floor(Math.random() * starSymbols.length)];
                
                // Random position
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                
                // Random animation delay and duration
                star.style.animationDelay = Math.random() * 3 + 's';
                star.style.animationDuration = (2 + Math.random() * 3) + 's';
                
                starField.appendChild(star);
            }
        }

        // Create Nyan Star Overlay Effects
        function createNyanStarOverlay() {
            const starOverlay = document.getElementById('nyan-star-overlay');
            if (!starOverlay) return;

            const starSymbols = ['‚≠ê', '‚ú®', 'üí´', '‚≠ê', '‚ú®', 'üí´', '‚ú¶', '‚úß', '‚ãÜ'];

            // Create stars periodically like the original nyan cat
            setInterval(() => {
                const star = document.createElement('div');
                star.className = 'nyan-star';
                star.textContent = starSymbols[Math.floor(Math.random() * starSymbols.length)];
                
                // Random vertical position within the container
                const randomY = 2 + Math.random() * 4; // 2-6vh range (center around turtle)
                star.style.top = randomY + 'vh';
                star.style.left = '50%'; // Start from turtle center position
                
                // Random animation delay and duration variation
                const duration = 2 + Math.random() * 0.5; // 2-2.5s (shorter, smoother)
                star.style.animationDelay = Math.random() * 0.3 + 's';
                star.style.animationDuration = duration + 's';
                
                starOverlay.appendChild(star);
                
                // Remove star after animation completes
                setTimeout(() => {
                    if (starOverlay.contains(star)) {
                        starOverlay.removeChild(star);
                    }
                }, (duration + 0.5) * 1000); // Duration + smaller buffer
                
            }, 600); // Create new star every 600ms (less frequent, more natural)
        }

        // Update Moon Phase Display
        function updateMoonPhase() {
            const moonData = getMoonPhase();
            
            const moonIcon = document.getElementById('moon-icon');
            const moonInfo = document.getElementById('moon-info');
            const moonPhaseName = document.getElementById('moon-phase-name');

            if (moonIcon) moonIcon.textContent = moonData.phaseIcon;
            if (moonInfo) moonInfo.textContent = `${moonData.illumination}%`;
            if (moonPhaseName) moonPhaseName.textContent = moonData.phaseName;
            
            console.log(`üåô Moon Phase: ${moonData.phaseName} (${moonData.illumination}% illuminated)`);
        }

        // Camera Management
        let currentCamera = 0;
        const cameraUrls = [
            'http://10.0.20.69:8000/api/camera/stream',  // Primary MJPEG stream
            'http://10.0.20.69:8000/api/camera/live',    // Live still frames
            'http://10.0.20.69/api/camera/stream',       // Nginx proxy fallback
            '/api/camera/live'                           // Local fallback
        ];

        function initializeCamera() {
            console.log('üé• Initializing camera system...');
            tryNextCamera();
        }

        function tryNextCamera() {
            if (currentCamera >= cameraUrls.length) {
                showCameraError();
                return;
            }

            const cameraStream = document.getElementById('camera-stream');
            const cameraPlaceholder = document.getElementById('camera-placeholder');
            const cameraError = document.getElementById('camera-error');
            const cameraStatus = document.getElementById('camera-status');

            if (cameraPlaceholder) cameraPlaceholder.classList.add('show');
            if (cameraError) cameraError.classList.remove('show');
            
            if (cameraStatus) {
                cameraStatus.textContent = 'üìπ Connecting...';
                cameraStatus.className = 'camera-status offline';
            }

            console.log(`üìπ Trying camera URL: ${cameraUrls[currentCamera]}`);

            if (cameraStream) {
                // Add aggressive cache-busting to avoid browser cache issues
                const streamUrl = cameraUrls[currentCamera] + '?cache_bust=' + Date.now() + '&r=' + Math.random();
                
                cameraStream.onload = () => {
                    console.log('‚úÖ Camera connected successfully!');
                    showCameraStream();
                };
                
                cameraStream.onerror = () => {
                    console.log(`‚ùå Camera failed: ${cameraUrls[currentCamera]}`);
                    currentCamera++;
                    setTimeout(tryNextCamera, 2000); // Longer timeout between attempts
                };
                
                // Clear src first to force reload
                cameraStream.src = '';
                setTimeout(() => {
                    cameraStream.src = streamUrl;
                }, 100);
            }
        }

        function showCameraStream() {
            const cameraStream = document.getElementById('camera-stream');
            const cameraPlaceholder = document.getElementById('camera-placeholder');
            const cameraError = document.getElementById('camera-error');
            const cameraStatus = document.getElementById('camera-status');

            if (cameraStream) cameraStream.style.display = 'block';
            if (cameraPlaceholder) cameraPlaceholder.classList.remove('show');
            if (cameraError) cameraError.classList.remove('show');
            
            if (cameraStatus) {
                cameraStatus.textContent = 'üìπ Live Feed';
                cameraStatus.className = 'camera-status online';
            }
        }

        function showCameraError() {
            const cameraStream = document.getElementById('camera-stream');
            const cameraPlaceholder = document.getElementById('camera-placeholder');
            const cameraError = document.getElementById('camera-error');
            const cameraStatus = document.getElementById('camera-status');

            if (cameraStream) cameraStream.style.display = 'none';
            if (cameraPlaceholder) cameraPlaceholder.classList.remove('show');
            if (cameraError) cameraError.classList.add('show');
            
            if (cameraStatus) {
                cameraStatus.textContent = 'üìπ No Camera';
                cameraStatus.className = 'camera-status offline';
            }

            console.log('‚ùå All camera sources failed');
        }

        // Camera Control Functions
        function refreshCamera() {
            console.log('üîÑ Refreshing camera...');
            currentCamera = 0;
            tryNextCamera();
        }

        function switchCamera() {
            console.log('üì∑ Switching to next camera...');
            currentCamera = (currentCamera + 1) % cameraUrls.length;
            tryNextCamera();
        }

        function toggleFullscreen() {
            const cameraFeed = document.querySelector('.camera-feed');
            if (cameraFeed) {
                if (!document.fullscreenElement) {
                    cameraFeed.requestFullscreen().catch(err => {
                        console.log('Fullscreen failed:', err);
                    });
                } else {
                    document.exitFullscreen();
                }
            }
        }

        // Initialize Animations
        function initializeAnimations() {
            createStarField();
            createNyanStarOverlay();
            updateMoonPhase();
            
            // Update moon phase daily
            setInterval(updateMoonPhase, 24 * 60 * 60 * 1000);
        }

        // Initialize dashboard
        console.log('üê¢ TurtX Multi-Page Monitor initializing...');
        console.log('üîó API Endpoint:', `${API_BASE_URL}${API_ENDPOINTS.latest}`);
        console.log('üåü Initializing magical animations...');
        
        // Initialize animations first
        initializeAnimations();
        
        // Initialize camera system
        initializeCamera();
        
        // Initial data load
        updateData();
        
        // Update every 2 seconds
        const updateInterval = setInterval(updateData, 2000);
        console.log('‚úÖ TurtX Dashboard loaded! Updating every 2 seconds...');

        // Add error handling for network issues
        window.addEventListener('online', () => {
            console.log('üåê Network reconnected - resuming updates');
            clearInterval(updateInterval);
            setInterval(updateData, 2000);
        });

        window.addEventListener('offline', () => {
            console.log('‚ö†Ô∏è Network offline - will use cached/simulated data');
        });
    </script>
</body>
</html> 